<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Logout Functionality</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .test-container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            max-width: 600px;
            margin: 0 auto;
        }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #0056b3;
        }
        .success {
            color: green;
            font-weight: bold;
        }
        .error {
            color: red;
            font-weight: bold;
        }
        .info {
            color: blue;
        }
        pre {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 5px;
            border-left: 4px solid #007bff;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>ðŸ§ª Logout Functionality Test</h1>
        
        <div id="results"></div>
        
        <h3>Test Controls:</h3>
        <button onclick="testSessionStorage()">Test Session Storage</button>
        <button onclick="testLogoutFunction()">Test Logout Function</button>
        <button onclick="simulateLogin()">Simulate Login</button>
        <button onclick="clearSession()">Clear Session</button>
        <button onclick="checkElements()">Check Elements</button>
        
        <h3>Direct Admin Page Links:</h3>
        <button onclick="window.open('admin-dashboard.html', '_blank')">Open Dashboard</button>
        <button onclick="window.open('admin-review-queue.html', '_blank')">Open Review Queue</button>
        <button onclick="window.open('admin-closed-account.html', '_blank')">Open Closed Accounts</button>
        
        <h3>Console Output:</h3>
        <pre id="console-output"></pre>
    </div>

    <script>
        let consoleOutput = document.getElementById('console-output');
        let results = document.getElementById('results');
        
        // Capture console output
        const originalLog = console.log;
        console.log = function(...args) {
            originalLog.apply(console, args);
            consoleOutput.textContent += args.join(' ') + '\n';
            consoleOutput.scrollTop = consoleOutput.scrollHeight;
        };
        
        function updateResults(message, type = 'info') {
            const div = document.createElement('div');
            div.className = type;
            div.innerHTML = `[${new Date().toLocaleTimeString()}] ${message}`;
            results.appendChild(div);
            results.scrollTop = results.scrollHeight;
        }
        
        function testSessionStorage() {
            updateResults('Testing session storage...', 'info');
            
            const items = [
                'employee_id', 
                'employee_username', 
                'employee_position', 
                'admin_session'
            ];
            
            items.forEach(item => {
                const value = localStorage.getItem(item);
                updateResults(`${item}: ${value || 'null'}`, value ? 'success' : 'error');
            });
        }
        
        function testLogoutFunction() {
            updateResults('Testing logout function...', 'info');
            
            if (window.testLogout) {
                try {
                    window.testLogout();
                    updateResults('Logout function executed successfully', 'success');
                } catch (error) {
                    updateResults(`Logout function error: ${error.message}`, 'error');
                }
            } else {
                updateResults('testLogout function not found', 'error');
            }
        }
        
        function simulateLogin() {
            updateResults('Simulating admin login...', 'info');
            
            localStorage.setItem('employee_id', 'test123');
            localStorage.setItem('employee_username', 'testadmin');
            localStorage.setItem('employee_position', 'Administrator');
            localStorage.setItem('admin_session', Date.now().toString());
            
            updateResults('Login simulation complete', 'success');
            testSessionStorage();
        }
        
        function clearSession() {
            updateResults('Clearing all session data...', 'info');
            
            localStorage.clear();
            sessionStorage.clear();
            
            updateResults('Session data cleared', 'success');
        }
        
        function checkElements() {
            updateResults('Checking for logout elements in admin pages...', 'info');
            
            // This would need to be run from an actual admin page
            updateResults('Note: This test should be run from an admin page to check elements', 'info');
            
            // Check if logout-fix.js is loaded
            if (window.setupLogoutFunctionality) {
                updateResults('logout-fix.js is loaded and functional', 'success');
            } else {
                updateResults('logout-fix.js not detected', 'error');
            }
        }
        
        // Initialize
        updateResults('Logout test page loaded', 'success');
        testSessionStorage();
    </script>
</body>
</html>
